<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="LoGeCuiMobile.Pages.MesRecettesPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:tr="clr-namespace:LoGeCuiMobile.Resources.Lang"
    Title="{tr:Translate Recipes_Title}">

    <Grid Padding="12" RowDefinitions="Auto,*" RowSpacing="10">

        <!-- Zone haute fixe -->
        <VerticalStackLayout Grid.Row="0" Spacing="10">

            <Picker Title="{tr:Translate Recipes_Category}"
                    ItemsSource="{Binding Categories}"
                    SelectedItem="{Binding SelectedCategorie}" />

            <HorizontalStackLayout Spacing="10">
                <Button Text="{tr:Translate Recipes_Refresh}"
                        Command="{Binding RefreshCommand}"
                        HorizontalOptions="StartAndExpand" />

                <Button Text="{tr:Translate Recipes_Add}"
                        Clicked="OnAjouterRecetteClicked"
                        HorizontalOptions="EndAndExpand" />
            </HorizontalStackLayout>

            <ActivityIndicator IsRunning="{Binding IsBusy}"
                               IsVisible="{Binding IsBusy}" />

        </VerticalStackLayout>

        <!-- Liste scrollable -->
        <CollectionView Grid.Row="1"
                        x:Name="RecettesCollection"
                        ItemsSource="{Binding Recettes}"
                        SelectionMode="None">

            <CollectionView.EmptyView>
                <Label Text="{tr:Translate Recipes_Empty}"
                       HorizontalTextAlignment="Center"
                       VerticalTextAlignment="Center"
                       Margin="0,30,0,0" />
            </CollectionView.EmptyView>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Padding="10"
                           Margin="0,6"
                           BorderColor="LightGray"
                           HasShadow="False">

                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnRecetteTapped"
                                                  CommandParameter="{Binding .}" />
                        </Frame.GestureRecognizers>

                        <VerticalStackLayout Spacing="4">
                            <Label Text="{Binding Nom}"
                                   FontSize="18" />

                            <Label Text="{Binding TypeTexte}" />

                            <!-- Temps: {0} min -->
                            <Label Text="{Binding TempsPreparation, StringFormat='{tr:Translate Recipes_TimeFormat}'}" />

                            <Label Text="{Binding DifficulteTexte}" />
                        </VerticalStackLayout>

                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>

        </CollectionView>

    </Grid>
</ContentPage>
