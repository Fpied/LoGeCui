<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:tr="clr-namespace:LoGeCuiMobile.Resources.Lang"
    xmlns:conv="clr-namespace:LoGeCuiMobile.Converters"
    x:Class="LoGeCuiMobile.Pages.MesIngredientsPage"
    Title="{tr:Translate Ingredients_Title}">

    <ContentPage.Resources>
        <ResourceDictionary>
            <conv:QuantityFormatConverter x:Key="QuantityFormatConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid Padding="16" RowDefinitions="Auto,*" RowSpacing="12">

        <Button
            Grid.Row="0"
            Text="{tr:Translate Ingredients_AddButton}"
            BackgroundColor="#28a745"
            TextColor="White"
            Clicked="OnAddIngredientClicked" />

        <CollectionView
            Grid.Row="1"
            x:Name="IngredientsCollection"
            SelectionMode="Single"
            SelectionChanged="OnIngredientSelected">

            <CollectionView.ItemTemplate>
                <DataTemplate>

                    <Frame
                        Padding="12"
                        Margin="0,4"
                        BorderColor="#ddd"
                        CornerRadius="10">

                        <Grid ColumnDefinitions="*,Auto">

                            <VerticalStackLayout Spacing="4">

                                <Label
                                    Text="{Binding Nom}"
                                    FontSize="18"
                                    FontAttributes="Bold" />

                                <Label FontSize="14" TextColor="Gray">
                                    <Label.Text>
                                        <MultiBinding Converter="{StaticResource QuantityFormatConverter}">
                                            <Binding Path="Quantite"/>
                                            <Binding Path="Unite"/>
                                        </MultiBinding>
                                    </Label.Text>
                                </Label>

                                <HorizontalStackLayout Spacing="6">
                                    <CheckBox IsChecked="{Binding EstDisponible}" />
                                    <Label Text="{tr:Translate Ingredients_Available}"
                                           VerticalTextAlignment="Center"/>
                                </HorizontalStackLayout>

                            </VerticalStackLayout>

                            <Button
                                Grid.Column="1"
                                Text="ðŸ—‘"
                                BackgroundColor="#e74c3c"
                                Clicked="OnDeleteIngredientClicked" />

                        </Grid>
                    </Frame>

                </DataTemplate>
            </CollectionView.ItemTemplate>

        </CollectionView>

    </Grid>
</ContentPage>
