<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:tr="clr-namespace:LoGeCuiMobile.Resources.Lang"
    xmlns:conv="clr-namespace:LoGeCuiMobile.Converters"
    x:Class="LoGeCuiMobile.Pages.MesIngredientsPage"
    Title="{tr:Translate Ingredients_Title}">

    <ContentPage.Resources>
        <ResourceDictionary>
            <conv:QuantityFormatConverter x:Key="QuantityFormatConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid Padding="16" RowDefinitions="Auto,Auto,*" RowSpacing="12">

        <!-- Boutons -->
        <Grid Grid.Row="0" ColumnSpacing="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Button Grid.Column="0"
                    Text="{tr:Translate Ingredients_AddButton}"
                    BackgroundColor="#28a745"
                    TextColor="White"
                    Clicked="OnAddIngredientClicked" />

            <Button Grid.Column="1"
                    x:Name="BtnSupprimerSelectionIngredients"
                    Text="Supprimer sÃ©lection"
                    BackgroundColor="#E67E22"
                    TextColor="White"
                    Clicked="OnDeleteSelectedIngredientsClicked" />
        </Grid>

        <!-- Checkbox Tout sÃ©lectionner -->
        <HorizontalStackLayout Grid.Row="1" Spacing="10" Padding="4,0">
            <CheckBox x:Name="ChkToutSelectionnerIngredients"
                      CheckedChanged="ChkToutSelectionnerIngredients_CheckedChanged" />
            <Label Text="Tout sÃ©lectionner"
                   VerticalTextAlignment="Center"
                   TextColor="Gray" />
        </HorizontalStackLayout>

        <!-- Liste -->
        <CollectionView Grid.Row="2"
                        x:Name="IngredientsCollection"
                        SelectionMode="None">

            <CollectionView.EmptyView>
                <Label Text="Aucun ingrÃ©dient."
                       HorizontalOptions="Center"
                       Margin="0,20,0,0"
                       TextColor="Gray"/>
            </CollectionView.EmptyView>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Padding="12"
                           Margin="0,4"
                           BorderColor="#ddd"
                           CornerRadius="10">

                        <Grid ColumnDefinitions="*,Auto">

                            <VerticalStackLayout Spacing="6">

                                <Label Text="{Binding Nom}"
                                       FontSize="18"
                                       FontAttributes="Bold" />

                                <Label FontSize="14" TextColor="Gray">
                                    <Label.Text>
                                        <MultiBinding Converter="{StaticResource QuantityFormatConverter}">
                                            <Binding Path="Quantite"/>
                                            <Binding Path="Unite"/>
                                        </MultiBinding>
                                    </Label.Text>
                                </Label>

                                <!-- Disponible -->
                                <HorizontalStackLayout Spacing="6">
                                    <CheckBox IsChecked="{Binding EstDisponible}"
                                                CheckedChanged="OnDisponibleChanged" />
                                    <Label Text="{tr:Translate Ingredients_Available}"
                                           VerticalTextAlignment="Center"/>
                                </HorizontalStackLayout>

                                <!-- SÃ©lection suppression -->
                                <HorizontalStackLayout Spacing="6">
                                    <CheckBox IsChecked="{Binding IsSelectedForDelete}" />
                                    <Label Text="Supprimer"
                                           VerticalTextAlignment="Center"
                                           TextColor="Gray"/>
                                </HorizontalStackLayout>

                            </VerticalStackLayout>

                            <!-- Supprimer item -->
                            <Button Grid.Column="1"
                                    Text="ðŸ—‘"
                                    BackgroundColor="#e74c3c"
                                    Clicked="OnDeleteIngredientClicked" />
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>

        </CollectionView>
    </Grid>
</ContentPage>
