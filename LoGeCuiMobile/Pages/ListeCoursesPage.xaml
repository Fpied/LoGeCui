<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:conv="clr-namespace:LoGeCuiMobile.Converters"
             xmlns:tr="clr-namespace:LoGeCuiMobile.Resources.Lang"
             x:Class="LoGeCuiMobile.Pages.ListeCoursesPage"
             Title="{tr:Translate Shopping_Title}">

    <ContentPage.Resources>
        <ResourceDictionary>
            <conv:BoolToStrikethroughConverter x:Key="BoolToStrikethroughConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid Padding="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Label Grid.Row="0"
               Text="{tr:Translate Shopping_Header}"
               FontSize="24"
               FontAttributes="Bold"
               HorizontalOptions="Center"
               Margin="0,10,0,10"/>

        <!-- Buttons -->
        <Grid Grid.Row="1" ColumnSpacing="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Button Grid.Column="0"
                    Text="{tr:Translate Shopping_AddItem}"
                    BackgroundColor="#27AE60"
                    FontAttributes="Bold"
                    Clicked="BtnAjouter_Clicked" />

            <Button Grid.Column="1"
                    x:Name="BtnSupprimerSelection"
                    Text="{tr:Translate Shopping_DeleteSelection}"
                    BackgroundColor="#E67E22"
                    FontAttributes="Bold"
                    Clicked="BtnSupprimerSelection_Clicked"/>
        </Grid>

        <!-- Selection info (garde vide, tu remplis en C#) -->
        <Label Grid.Row="2"
               x:Name="SelectionInfoLabel"
               Text=""
               TextColor="Gray"
               Margin="0,8,0,8"/>

        <CollectionView Grid.Row="3"
                        x:Name="ListeCourses"
                        SelectionMode="None">

            <CollectionView.EmptyView>
                <Label Text="{tr:Translate Shopping_Empty}"
                       HorizontalOptions="Center"
                       Margin="0,20,0,0"
                       TextColor="Gray"/>
            </CollectionView.EmptyView>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Margin="6"
                           Padding="14"
                           BorderColor="#DDDDDD"
                           CornerRadius="12"
                           HasShadow="True">

                        <Frame.BackgroundColor>
                            <AppThemeBinding Light="White"
                                             Dark="#1E1E1E" />
                        </Frame.BackgroundColor>

                        <VerticalStackLayout Spacing="8">

                            <!-- Nom -->
                            <Label Text="{Binding Nom}"
                                   FontSize="18"
                                   FontAttributes="Bold"
                                   TextDecorations="{Binding EstAchete, Converter={StaticResource BoolToStrikethroughConverter}}">
                                <Label.TextColor>
                                    <AppThemeBinding Light="Black"
                                                     Dark="White" />
                                </Label.TextColor>
                            </Label>

                            <!-- Quantité -->
                            <Label FontSize="14">
                                <Label.TextColor>
                                    <AppThemeBinding Light="#666666"
                                                     Dark="#CCCCCC" />
                                </Label.TextColor>

                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span Text="{Binding Quantite}"/>
                                        <Span Text=" "/>
                                        <Span Text="{Binding Unite}"/>
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>

                            <!-- Actions -->
                            <HorizontalStackLayout Spacing="20">

                                <!-- Acheté -->
                                <HorizontalStackLayout Spacing="6">
                                    <CheckBox IsChecked="{Binding EstAchete, Mode=TwoWay}"
                                              CheckedChanged="CheckBox_CheckedChanged"/>
                                    <Label Text="{tr:Translate Shopping_Bought}"
                                           VerticalOptions="Center">
                                        <Label.TextColor>
                                            <AppThemeBinding Light="Black"
                                                             Dark="White" />
                                        </Label.TextColor>
                                    </Label>
                                </HorizontalStackLayout>

                                <!-- Supprimer -->
                                <HorizontalStackLayout Spacing="6">
                                    <CheckBox IsChecked="{Binding IsSelectedForDelete}"/>
                                    <Label Text="{tr:Translate Shopping_Delete}"
                                           VerticalOptions="Center">
                                        <Label.TextColor>
                                            <AppThemeBinding Light="Black"
                                                             Dark="White" />
                                        </Label.TextColor>
                                    </Label>
                                </HorizontalStackLayout>

                            </HorizontalStackLayout>

                        </VerticalStackLayout>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>

        </CollectionView>
    </Grid>

</ContentPage>




