<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:conv="clr-namespace:LoGeCuiMobile.Converters"
             x:Class="LoGeCuiMobile.Pages.ListeCoursesPage"
             Title="ðŸ›’ Liste de Courses">

    <ContentPage.Resources>
        <ResourceDictionary>
            <conv:BoolToStrikethroughConverter x:Key="BoolToStrikethroughConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid Padding="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Label Grid.Row="0"
               Text="Ma liste de courses"
               FontSize="24"
               FontAttributes="Bold"
               HorizontalOptions="Center"
               Margin="0,10,0,10"/>

        <Grid Grid.Row="1" ColumnSpacing="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Button Grid.Column="0"
                    Text="âž• Ajouter un article"
                    BackgroundColor="#27AE60"
                    TextColor="White"
                    FontAttributes="Bold"
                    Clicked="BtnAjouter_Clicked" />

            <Button Grid.Column="1"
                    x:Name="BtnSupprimerSelection"
                    Text="ðŸ—‘ï¸ Supprimer sÃ©lection"
                    BackgroundColor="#E67E22"
                    TextColor="White"
                    FontAttributes="Bold"
                    Clicked="BtnSupprimerSelection_Clicked"/>
        </Grid>

        <Label Grid.Row="2"
               x:Name="SelectionInfoLabel"
               Text=""
               TextColor="Gray"
               Margin="0,8,0,8"/>

        <CollectionView Grid.Row="3"
                        x:Name="ListeCourses"
                        SelectionMode="None">

            <CollectionView.EmptyView>
                <Label Text="Aucun article pour l'instant."
                       HorizontalOptions="Center"
                       Margin="0,20,0,0"
                       TextColor="Gray"/>
            </CollectionView.EmptyView>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Margin="6"
               Padding="14"
               BackgroundColor="White"
               BorderColor="#DDDDDD"
               CornerRadius="12"
               HasShadow="True">

                        <VerticalStackLayout Spacing="8">

                            <!-- Nom -->
                            <Label Text="{Binding Nom}"
                       FontSize="18"
                       FontAttributes="Bold"
                       TextDecorations="{Binding EstAchete, Converter={StaticResource BoolToStrikethroughConverter}}"/>

                            <!-- QuantitÃ© -->
                            <Label FontSize="14"
                       TextColor="Gray">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span Text="{Binding Quantite}"/>
                                        <Span Text=" "/>
                                        <Span Text="{Binding Unite}"/>
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>

                            <!-- Actions -->
                            <HorizontalStackLayout Spacing="20">

                                <!-- AchetÃ© -->
                                <HorizontalStackLayout Spacing="6">
                                    <CheckBox IsChecked="{Binding EstAchete, Mode=TwoWay}"
                                  CheckedChanged="CheckBox_CheckedChanged"/>
                                    <Label Text="AchetÃ©"
                               VerticalOptions="Center"/>
                                </HorizontalStackLayout>

                                <!-- SÃ©lection suppression -->
                                <HorizontalStackLayout Spacing="6">
                                    <CheckBox IsChecked="{Binding IsSelectedForDelete}"/>
                                    <Label Text="Supprimer"
                               VerticalOptions="Center"/>
                                </HorizontalStackLayout>

                            </HorizontalStackLayout>

                        </VerticalStackLayout>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>

        </CollectionView>
    </Grid>

</ContentPage>



